!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof module&&module.exports?module.exports=b():a.typeFactory=b()}(this,function(){function a(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function b(b,c,d){var e=c.hasOwnProperty("constructor")?c.constructor:function(){b?b.apply(this,arguments):this.initialize&&this.initialize.apply(this,arguments)};if(b){var f=function(){this.constructor=e};f.prototype=b.prototype,e.prototype=new f,a(e,b)}return a(e,d),a(e.prototype,c),e}return function(a,c){var d=b(null,a,c);return d.extend=function(a,c){return b(this,a,c)},d}});
!function(a,b){"function"==typeof define&&define.amd?define(["type-factory","jquery"],b):"object"==typeof module&&module.exports?module.exports=b(require("type-factory"),require("jquery")):a.SimpleView=b(typeFactory,jQuery)}(this,function(a,b){var c=0;return a({delegatedEvents:!0,constructor:function(a){this.cid="view"+ ++c,a&&a.$el&&(this.$el=a.$el instanceof b?a.$el:b(a.$el).eq(0),delete a.$el),this.events&&this.$el&&this.setupEvents(),this.beforeInitialize&&this.beforeInitialize.apply(this,arguments),this.initialize&&this.initialize.apply(this,arguments)},setupEvents:function(){var a=this.ens=this.ens||"."+this.cid,c=this,d={document:window.document,window:window};return b.each("function"==typeof this.events?this.events():this.events,function(e,f){var g=0===e.indexOf("one:"),h=(g?e.slice(4):e).split(" "),i=h[0]+a,j=h.slice(1).join(" "),k=c.$el;d[j]?(k=c["$"+j]=c["$"+j]||b(d[j]),j=void 0):c.delegatedEvents||((c.elementsWithBoundEvents=c.elementsWithBoundEvents||[]).push(k=k.find(j)),j=void 0),k[g?"one":"on"](i,j,function(){("function"==typeof f?f:c[f]).apply(c,arguments)})}),this},removeEvents:function(){var a=this.ens;return a&&(this.$el.off(a),this.$document&&this.$document.off(a),this.$window&&this.$window.off(a),this.elementsWithBoundEvents&&(b.each(this.elementsWithBoundEvents,function(c,d){b(d).off(a)}),this.elementsWithBoundEvents=null)),this},remove:function(){return this.trigger("beforeRemove"),this.removeEvents().abortDeferreds().removeViews(),this.$el.remove(),this.trigger("afterRemove"),this.off(),this},addDeferred:function(a){return this.deferreds=this.deferreds||[],(!Array.prototype.indexOf||this.deferreds.indexOf(a)<0)&&this.deferreds.push(a),a},abortDeferreds:function(){return this.deferreds&&b.each(this.deferreds,function(a,b){"object"==typeof b&&b.state&&"pending"===b.state()&&(b.abort?b.abort():b.reject())}),delete this.deferreds,this},when:function(a,c,d){var e=this;return b.each(a=b.isArray(a)?a:[a],function(a,b){e.addDeferred(b)}),b.when.apply(window,a).done(b.proxy(c,this)).fail(b.proxy(d,this))},addView:function(a){return this.views=this.subViews||{},this.views[a.cid]=a,a.on("afterRemove",function(){delete this.views[a.cid]}),a},removeViews:function(){return this.views&&b.each(this.views,function(a,b){b.remove()}),delete this.views,this},$:function(a){return this.$el.find(a)},on:function(a,b){return this.onCallbacks=this.onCallbacks||{},this.onCallbacks[a]=this.onCallbacks[a]||[],this.onCallbacks[a].push(b),this},off:function(a){return a&&this.onCallbacks?delete this.onCallbacks[a]:delete this.onCallbacks,this},trigger:function(a,c){var d=this;return this.onCallbacks&&this.onCallbacks[a]&&b.each(this.onCallbacks[a],function(a,b){b.call(d,c)}),this}})});